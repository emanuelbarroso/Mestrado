%TCIDATA{LaTeXparent=0,0,relatorio.tex}
                      

\chapter{Execução e Resultados do Algoritmo \textit{Smart Reservoir}} \label{CapDesenvolvimento}

%[\textit{RETROFITTING} DO ROBÔ ASEA IRB6-S2]
% Resumo opcional. Comentar se não usar.
%\resumodocapitulo{Resumo opcional.}

\section{Introdução}
Este capítulo é destinado à apresentação e discussão dos resultados da implementação do algoritmo \textit{Smart Reservoir} no MRST. Primeiramente, são apresentados os resultados dos testes utilizando o modelo \textit{Egg Model}; vários resultados são propostos de acordo com a construção do algoritmo vista no Capítulo \ref{CapMetodologia}. Em seguida, o mesmo \textit{Smart Reservoir} é testado com um modelo SAIGUP, e seus resultados coletados. Por fim, é feita uma discussão dos dados obtidos, tomando-se por base simulações dos modelos sem a estratégia de otimização e, no caso do \textit{Egg Model}, alguns resultados encontrados na literatura.

\section{Execução Utilizando o \textit{Egg Model}}
Inicialmente, é tomado o \textit{Egg Model} como modelo de reservatório a ser utilizado para se verificar o comportamento do \textit{Smart Reservoir}. Por ser o mais simples dos modelos utilizados nesta pesquisa, o \textit{Egg Model} foi utilizado em várias simulações, evidenciando a construção do algoritmo proposto. No total, são 5 simulações, que serão denominadas \textit{fases}. A Tabela \ref{tab:icEgg} mostra alguns dados comuns para todas as fases, evidenciando o estado inicial do reservatório.

\begin{table}[H]
	\centering
	\caption{Parâmetros iniciais do \textit{Egg Model} para todas as simulações. \label{tab:icEgg}}
\begin{tabular}{|c|c|}
	\hline
	\textbf{Descrição} & \textbf{Valor} \\ \hline
	Pressão de reservatório & $400\text{ bar}$ \\ \hline
	BHP de todos os produtores & $385\text{ bar}$ \\ \hline
	Vazões de injeção para os injetores & $60\text{ }m^3/\text{dia}$ \\ \hline
	Saturação inicial de óleo & $0.9$ \\ \hline
	Saturação inicial de água & $0.1$ \\ \hline
\end{tabular}
\end{table}

Em cada fase, a cada iteração, são analisadas paralelamente 7 diferentes possibilidades de configuração de pressão nos poços produtores. A taxa de variação de pressão considerada a cada passo tempo é dada por
\begin{equation}
	\label{eq:resultDelta}
	\delta_W^{(n+1)} = k_\delta \max\left(\kappa, h\left(s_o^{(n-1)}-s_o^{(n)}\right)\right),
\end{equation} em que $k_\delta$ é um fator de escala, $\kappa$ é um valor fixo mínimo considerado de forma a se evitar erros de simulação, $h$ é um peso para a variação de saturação e $s_o^{(n)}$ é a saturação de óleo no n-ésimo passo de tempo, considerada no ponto de encontro entre o poço produtor e o reservatório (lembrando que, caso não haja erros de simulação, $s_o^{(n-1)} \geq s_o^{(n)}$). No caso da primeira iteração, considerou-se $\delta_W^{(1)} = k_\delta \kappa$. A Tabela \ref{tab:deltaEgg} mostra o valor de cada uma das constantes que formam a taxa de variação dos poços produtores, em cada simulação realizada com o \textit{Egg Model}.

\begin{table}[H]
	\centering
	\caption{Constantes da taxa de variação utilizadas nas simulações envolvendo o \textit{Egg Model}.\label{tab:deltaEgg}}
\begin{tabular}{|c|c|c|c|}
	\hline
	\textbf{Fase} & $\mathbf{k_\delta}$ & $\mathbf{\kappa}$ & $\mathbf{h}$ \\
	\hline
	$1$ & $1.75$ & $10^{-5}$ & $0$ \\
	\hline
	$2$ & $1.75$ & $10^{-5}$ & $0$ \\
	\hline
	$3$ & $7$ & $10^{-5}$ & $0$ \\
	\hline
	$4$ & $7$ & $10^{-4}$ & $10^{-3}$ \\
	\hline
	$5$ & $1.75$ & $10^{-3}$ & $10^{-2}$ \\
	\hline
\end{tabular}
\end{table}

Em cada fase considerada no estudo do \textit{Smart Reservoir} utilizando o \textit{Egg Model}, foram realizadas três simulações: uma padrão, sem nenhum algoritmo implementado (denominada CI --- \textit{constant injection}); utilizando as configurações dos poços injetores proposta por Fonseca \textit{et al.}\footnote{Os dados foram tomados do algoritmo que produziu os melhores resultados econômicos, o ssStoSAG \cite{fonseca}}; e uma simulação utilizando o \textit{Smart Reservoir}, que também pode ser chamado de \textit{Smart CI}, referenciando-se o fato de que, em condições normais, as vazões de injeção de água serão mantidas constantes.

A fase 1 do estudo com o \textit{Egg Model} consistiu de uma simulação em que a janela temporal onde são feitas as comparações entre as possibilidades de controle é simples, isto é, cada janela é de um passo apenas. É considerada a fase do ponto de partida da construção do \textit{Smart Reservoir}. A Figura \ref{fig:eggBHP1} ilustra o controle de pressão obtido, enquanto que a Figura \ref{fig:eggNPV1} mostra, respectivamente, as curvas de NPV de cada uma das simulações consideradas e um destaque dessas curvas no tempo total de produção do reservatório sob uso do \textit{Smart Reservoir}. Os resultados referentes às vazões de água e óleo em cada poço produtor se encontram no Apêndice \ref{apn:egg1}.

\begin{figure}[H]
	\centering
	\includegraphics[width=.75\textwidth]{figs/resultadosEgg/imgsim1/EGG_SmartControl}
	\caption{Controle de pressão do \textit{Egg Model}, fase 1\label{fig:eggBHP1}}
\end{figure}

\begin{figure}[H]
	\centering
	\begin{subfigure}[b]{.45\textwidth}
		\includegraphics[width=\textwidth]{figs/resultadosEgg/imgsim1/EGG_CumulativeNPV}
		\caption{Visão inteira}
		\label{fig:eggNPV1Int}
	\end{subfigure}
	~
	\begin{subfigure}[b]{.45\textwidth}
		\includegraphics[width=\textwidth]{figs/resultadosEgg/imgsim1/EGG_CumulativeNPVZoom}
		\caption{Visão destacada}
		\label{fig:eggNPV1Zoom}
	\end{subfigure}
	\caption{NPVs resultantes do \textit{Egg Model}, fase 1 \label{fig:eggNPV1}}
\end{figure}

A fase 2 das simulações propostas para o \textit{Egg Model} tomou por base as mesmas constantes de cálculo da taxa de variação presentes na fase 1; porém, foi considerada uma janela de tempo dupla, ou seja, a janela de predição. O controle de pressões resultante é representado na Figura \ref{fig:eggBHP2}, enquanto que as curvas de NPV obtidas são apresentadas na Figura \ref{fig:eggNPV2}. Os resultados das vazões de água e óleo em cada poço produtor se encontram no Apêndice \ref{apn:egg2}.

\begin{figure}[H]
	\centering
	\includegraphics[width=.75\textwidth]{figs/resultadosEgg/imgsim2/EGG_SmartControl}
	\caption{Controle de pressão do \textit{Egg Model}, fase 2\label{fig:eggBHP2}}
\end{figure}

\begin{figure}[H]
	\centering
	\begin{subfigure}[b]{.45\textwidth}
		\includegraphics[width=\textwidth]{figs/resultadosEgg/imgsim2/EGG_CumulativeNPV}
		\caption{Visão inteira}
		\label{fig:eggNPV2Int}
	\end{subfigure}
	~
	\begin{subfigure}[b]{.45\textwidth}
		\includegraphics[width=\textwidth]{figs/resultadosEgg/imgsim2/EGG_CumulativeNPVZoom}
		\caption{Visão destacada}
		\label{fig:eggNPV2Zoom}
	\end{subfigure}
	\caption{NPVs resultantes do \textit{Egg Model}, fase 2 \label{fig:eggNPV2}}
\end{figure}

A fase 3 pode ser considerada uma fase de ajuste da taxa de variação em relação à fase 2; foi testado o limite de ajuste dos valores de $\delta_W$, mantido constante, que permitem uma simulação sem a presença de erros numéricos. As Figuras \ref{fig:eggBHP3} e \ref{fig:eggNPV3} mostram, respectivamente, o controle de pressões e as curvas de NPV desta fase. As vazões de água e óleo em cada poço produtor são apresentadas no Apêndice \ref{apn:egg3}.

\begin{figure}[H]
	\centering
	\includegraphics[width=.75\textwidth]{figs/resultadosEgg/imgsim3/EGG_SmartControl}
	\caption{Controle de pressão do \textit{Egg Model}, fase 3\label{fig:eggBHP3}}
\end{figure}

\begin{figure}[H]
	\centering
	\begin{subfigure}[b]{.45\textwidth}
		\includegraphics[width=\textwidth]{figs/resultadosEgg/imgsim3/EGG_CumulativeNPV}
		\caption{Visão inteira}
		\label{fig:eggNPV3Int}
	\end{subfigure}
	~
	\begin{subfigure}[b]{.45\textwidth}
		\includegraphics[width=\textwidth]{figs/resultadosEgg/imgsim3/EGG_CumulativeNPVZoom}
		\caption{Visão destacada}
		\label{fig:eggNPV3Zoom}
	\end{subfigure}
	\caption{NPVs resultantes do \textit{Egg Model}, fase 3 \label{fig:eggNPV3}}
\end{figure}

Feitas as simulações considerando taxas de variação de pressão constantes, procedeu-se às simulações em que tais taxas passam a depender da saturação. A fase 4 é a primeira simulação neste sentido, em que há agora um peso sobre a variação de saturação a cada passo de tempo. O controle de pressões resultante é mostrado na Figura \ref{fig:eggBHP4}, enquanto que as curvas de NPV obtidas são ilustradas na Figura \ref{fig:eggNPV4}. Os resultados referentes às vazões de água e óleo em cada poço produtor se encontram no Apêndice \ref{apn:egg4}.

\begin{figure}[H]
	\centering
	\includegraphics[width=.75\textwidth]{figs/resultadosEgg/imgsim4/EGG_SmartControl}
	\caption{Controle de pressão do \textit{Egg Model}, fase 4\label{fig:eggBHP4}}
\end{figure}

\begin{figure}[H]
	\centering
	\begin{subfigure}[b]{.45\textwidth}
		\includegraphics[width=\textwidth]{figs/resultadosEgg/imgsim4/EGG_CumulativeNPV}
		\caption{Visão inteira}
		\label{fig:eggNPV4Int}
	\end{subfigure}
	~
	\begin{subfigure}[b]{.45\textwidth}
		\includegraphics[width=\textwidth]{figs/resultadosEgg/imgsim4/EGG_CumulativeNPVZoom}
		\caption{Visão destacada}
		\label{fig:eggNPV4Zoom}
	\end{subfigure}
	\caption{NPVs resultantes do \textit{Egg Model}, fase 4 \label{fig:eggNPV4}}
\end{figure}

Por fim, a fase 5 do \textit{Egg Model} consiste na simulação completa, com janela de predição, taxas de variação de pressão dependentes da saturação dos poços e a adição do fator percentual de correção numérica $b_{\%} = 4\%$. Os resultados de controle de pressão e as curvas de NPV são apresentados, respectivamente, nas Figuras \ref{fig:eggBHP5} e \ref{fig:eggNPV5}. O Apêndice \ref{apn:egg5} contém os resultados das vazões de óleo e água em cada poço produtor.

\begin{figure}[H]
	\centering
	\includegraphics[width=.75\textwidth]{figs/resultadosEgg/imgsim5/EGG_SmartControl}
	\caption{Controle de pressão do \textit{Egg Model}, fase 5\label{fig:eggBHP5}}
\end{figure}

\begin{figure}[H]
	\centering
	\begin{subfigure}[b]{.45\textwidth}
		\includegraphics[width=\textwidth]{figs/resultadosEgg/imgsim5/EGG_CumulativeNPV}
		\caption{Visão inteira}
		\label{fig:eggNPV5Int}
	\end{subfigure}
	~
	\begin{subfigure}[b]{.45\textwidth}
		\includegraphics[width=\textwidth]{figs/resultadosEgg/imgsim5/EGG_CumulativeNPVZoom}
		\caption{Visão destacada}
		\label{fig:eggNPV5Zoom}
	\end{subfigure}
	\caption{NPVs resultantes do \textit{Egg Model}, fase 5 \label{fig:eggNPV5}}
\end{figure}

Nota-se que, observando-se o comportamento dos resultados de cada fase considerada, há um senso de progressão do \textit{Smart Reservoir} à medida em que passos complementares são adicionados ao mesmo. Todas as simulações foram realizadas no MRST versão 2018a, considerando-se que o tipo do simulador é o \textit{black oil}; além disso, cada passo de tempo, em todas as simulações do \textit{Egg Model}, foi de 90 dias.

\section{Execução Utilizando o Modelo SAIGUP}
Enquanto o \textit{Egg Model} foi utilizado nas simulações preliminares do \textit{Smart Reservoir}, evidenciando a construção do algoritmo, o SAIGUP foi utilizado para se obter resultados em um modelo de reservatório mais complexo e mais próximo de reservatórios reais. Ao contrário das simulações já tomadas, não se dispõe de resultados na literatura de NPVs para a configuração de poços do modelo SAIGUP utilizado; portanto, o NPV resultante será obtido apenas das simulações com a presença ou não do \textit{Smart Reservoir}. A obtenção da taxa de variação das pressões é feita utilizando-se a Equação \eqref{eq:resultDelta}, com as mesmas condições iniciais apresentadas nas simulações do \textit{Egg Model}. Além disso, todas as simulações do SAIGUP contaram com o fator de correção numérica $b_{\%} = 1\%$.

No caso do SAIGUP, foram feitas duas classes de simulações, considerando dois valores constantes de injeção distintos: na primeira simulação, denominada \textit{SAIGUP de longo prazo}, foi considerado um valor de injeção menor, tal que o tempo total de produção seja considerável; na segunda simulação, o \textit{SAIGUP de curto prazo}, as vazões de injeção foram aumentadas, de maneira a se obter um tempo de simulação mais compatível com a situação de um reservatório real. A Tabela \ref{tab:SAIGUPparams} mostra os parâmetros das simulações efetuadas, juntamente com as constantes das taxas de variação de pressão.

\begin{table}[H]
	\centering
	\caption{Parâmetros para as simulações envolvendo SAIGUP. \label{tab:SAIGUPparams}}
\begin{tabular}{|c|c|}
	\hline
	\textbf{Descrição} & \textbf{Valor} \\ \hline
	BHP de todos os produtores & $300\text{ bar}$ \\ \hline
	Vazões de injeção de longo prazo & $500\text{ }m^3/\text{dia}$ \\ \hline
	Vazões de injeção de curto prazo & $5000\text{ }m^3/\text{dia}$ \\ \hline
	Saturação inicial de óleo & $1.0$ \\ \hline
	Saturação inicial de água & $0.0$ \\ \hline
	Taxa de variação, constante $k_\delta$ & $1$\\ \hline
	Taxa de variação, constante $\kappa$ & $10^{-5}$\\ \hline
	Taxa de variação, constante $h$ & $10^{-3}$\\ \hline
\end{tabular}
\end{table}

A primeira simulação, a de longo prazo, teve como tempo de simulação total 127 anos, sem a adição de qualquer algoritmo. Nota-se que é um tempo considerado muito grande para se operar um reservatório, visto que a rentabilidade do negócio tende a diminuir com o tempo, segundo a própria definição do NPV. Portanto, o uso do \textit{Smart Reservoir} é significativamente interessante neste caso, tendo em vista o objetivo principal de se acelerar a produção. Da mesma forma como foi procedido com o \textit{Egg Model}, foram consideradas, a cada passo de tempo, 7 possibilidades de pressão para os poços. Além disso, foi considerada também a janela de predição, de 2 passos normais. A Figura \ref{fig:lSAIGUPBHP} apresenta o controle de pressões resultante, enquanto que a Figura \ref{fig:lSAIGUPNPV} mostra as curvas de NPV, em visão integral e destacada, respectivamente. Por fim, os dados de vazão de óleo e água obtidos, para cada poço produtor, se encontram no Apêndice \ref{apn:lSAIGUP}. No caso do SAIGUP de longo prazo, cada passo de tempo considerado é de 1 ano.

\begin{figure}[H]
	\centering
	\includegraphics[width=.75\textwidth]{figs/resultadosLSAIGUP/LSAIGUP_SmartControl}
	\caption{Controle de pressão do SAIGUP de longo prazo\label{fig:lSAIGUPBHP}}
\end{figure}

\begin{figure}[H]
	\centering
	\begin{subfigure}[b]{.45\textwidth}
		\includegraphics[width=\textwidth]{figs/resultadosLSAIGUP/LSAIGUP_CumulativeNPV}
		\caption{Visão inteira}
		\label{fig:lSAIGUPNPVInt}
	\end{subfigure}
	~
	\begin{subfigure}[b]{.45\textwidth}
		\includegraphics[width=\textwidth]{figs/resultadosLSAIGUP/LSAIGUP_CumulativeNPVZoom}
		\caption{Visão destacada}
		\label{fig:lSAIGUPNPVZoom}
	\end{subfigure}
	\caption{NPVs resultantes do SAIGUP de longo prazo \label{fig:lSAIGUPNPV}}
\end{figure}

A segunda simulação envolvendo o SAIGUP foi a simulação de curto prazo. Quase todos os parâmetros foram mantidos, excetuando-se as vazões de injeção para os injetores, que foram aumentadas, e o comprimento de cada passo de tempo, que é de 90 dias, como no \textit{Egg Model}. A ideia de se aumentar as vazões de injeção foi de encurtar a vida útil do reservatório, considerando tempos de produção factíveis para situações reais. As Figuras \ref{fig:sSAIGUPBHP} e \ref{fig:sSAIGUPNPV} mostram, respectivamente, os controles de pressão e as curvas de NPV ao final da simulação. Os resultados de vazão se encontram no Apêndice \ref{apn:sSAIGUP}.

\begin{figure}[H]
	\centering
	\includegraphics[width=.75\textwidth]{figs/resultadosSSAIGUP/SSAIGUP_SmartControl}
	\caption{Controle de pressão do SAIGUP de curto prazo\label{fig:sSAIGUPBHP}}
\end{figure}

\begin{figure}[H]
	\centering
	\begin{subfigure}[b]{.45\textwidth}
		\includegraphics[width=\textwidth]{figs/resultadosSSAIGUP/SSAIGUP_CumulativeNPV}
		\caption{Visão inteira}
		\label{fig:sSAIGUPNPVInt}
	\end{subfigure}
	~
	\begin{subfigure}[b]{.45\textwidth}
		\includegraphics[width=\textwidth]{figs/resultadosSSAIGUP/SSAIGUP_CumulativeNPVZoom}
		\caption{Visão destacada}
		\label{fig:sSAIGUPNPVZoom}
	\end{subfigure}
	\caption{NPVs resultantes do SAIGUP de curto prazo \label{fig:sSAIGUPNPV}}
\end{figure}

\section{Discussão dos Resultados}
A primeira análise da execução do \textit{Smart Reservoir} leva em conta um modelo mais simples, o \textit{Egg Model}, no qual foi possível realizar várias simulações, de maneira a evidenciar a construção e os testes de taxas de variação de pressão na solução proposta. 

A ideia central de se dividir os testes do \textit{Egg Model} em cinco fases foi não só de mostrar a evolução de como o \textit{Smart Reservoir} foi construído, e quais adendos foram feitos ao longo do problema; um outro motivo do número de simulações feitas com o \textit{Egg Model} foi, através de testes sobre a taxa de variação das pressões, sobretudo sobre sua ordem de grandeza, testar a estabilidade até onde o algoritmo continuava estável numericamente antes de se progredir com os adicionais, como a taxa dependente da saturação dos poços e o fator de correção numérica; este último sendo um importante fator adicionado à função NPV modificada, de maneira a evitar inconsistências quando a variação de saturação em dado poço produtor tende a zero.

Ao se fazer a análise dos resultados obtidos com a implementação do \textit{Smart Reservoir}, duas variáveis importantes foram consideradas: o NPV e o número de passos de tempo até que o NPV passe a decrescer (o ponto de parada do algoritmo). No caso do NPV, foi feita uma análise quantitativa, isto é, o quanto foi gerado ao final de cada fase, comparando-o com o que foi encontrado na literatura e com o gerado sem nenhum algoritmo de otimização. Em termos de tempo de simulação, foi considerado o quanto ele foi reduzido, na implementação do \textit{Smart Reservoir} em todas as fases propostas, em relação aos 40 passos utilizados por Fonseca \textit{et al}\footnote{Ver \cite{fonseca}}. A Tabela \ref{tab:EggAnalysis} faz um comparativo das variáveis citadas entre cada fase do \textit{Smart Reservoir}, o modelo sem algoritmo de otimização e a solução encontrada na literatura.

%TODO tabela

\begin{table}[H]
	\centering
	\caption{Resultados de NPV e tempo para as simulações envolvendo o \textit{Egg Model}\label{tab:EggAnalysis}}
\begin{tabular}{|c|c|c|}
	\hline
	\textbf{Simulação} & \textbf{NPV }$\mathbf{(\times10^6\text{ USD})}$ & Passos de tempo (90 dias) \\ \hline
	Normal & 41.07 & 17 \\ \hline
	Literatura & & 40 \\ \hline
	\textit{Smart}, fase 1 & 41.11 & 16 \\ \hline
	\textit{Smart}, fase 2 & 41.14 & 17 \\ \hline
	\textit{Smart}, fase 3 & 41.43 & 17 \\ \hline
	\textit{Smart}, fase 4 & 43.94 & 15 \\ \hline
	\textit{Smart}, fase 5 & 44.71 & 16 \\ \hline
\end{tabular}
\end{table}

Após a análise e discussão dos resultados obtidos com o \textit{Egg Model}, considera-se agora os resultados utilizando o SAIGUP. O modelo disponível para o estudo possui uma quantidade de poços produtores inferior à dos modelos comumente utilizados na literatura --- Carter e Grema \textit{et al.} utilizam, por exemplo, oito poços produtores\footnote{Ver \cite{saigupCM} e \cite{grema2017optimization}}, enquanto que o modelo disponível possui apenas cinco. O número reduzido de produtores resulta em um período de produção extendido e em uma produção de óleo menor que a possível, considerando que, inicialmente, apenas a fase óleo está presente no reservatório, conforme dados da Tabela \ref{tab:SAIGUPparams}. 

Analisando-se os controles de pressão obtidos (Figuras \ref{fig:lSAIGUPBHP} e \ref{fig:sSAIGUPBHP}), nota-se que, a exemplo do \textit{Egg Model}, os poços produtores encontram-se inicialmente abertos; a tendência é que, ao longo do tempo, a pressão nos poços aumente, devido à presenção da frente de água nos mesmos; logo após esse aumento no BHP, os poços passam a produzir mais água do que óleo, razão pela qual, depois de determinado tempo, a pressão nos produtores começa a cair, possibilitando uma maior produção de fluidos e, consequentemente, um maior aproveitamento de óleo do reservatório. No caso do SAIGUP de curto prazo, o efeito da queda final de pressão é observado apenas no produtor 4 (os outros poços não chegam à fase de queda de pressão quando é detectado NPV negativo), enquanto que no de longo prazo o comportamento esperado, tanto a subida inicial quanto a queda de pressão, pode ser observado em todos os poços.

Analisando-se as curvas de vazão de óleo e água das simulações efetuadas com o SAIGUP, presentes nos Apêndices \ref{apn:lSAIGUP} e \ref{apn:sSAIGUP}, nota-se que o comportamento dos gráficos é suave, com um decaimento próximo ao exponencial no caso das vazões de óleo; entretanto, como há uma fase do \textit{Smart Reservoir} em que há um corte na vazão dos poços injetores, nota-se que esse fato se reflete nos resultados de vazão obtidos, principalmente nas curvas de vazão de água.

Em termos de NPV e tempo de explotação, em ambos os casos do SAIGUP o NPV resultante pode ser considerado equivalente nas situações normal e com a implementação do \textit{Smart Reservoir}; no entanto, percebe-se uma drástica redução no tempo total de simulação em ambos os casos: para aproximadamente 37.5\% do tempo original para o caso de curto prazo e para menos de 35\% do tempo original no caso de longo prazo, confirmando, assim, o cumprimento da ideia central da solução proposta.
